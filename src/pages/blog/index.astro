---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

const allPosts = await getCollection("blog");
// Sort posts by date in descending order (most recent first)
const sortedPosts = allPosts.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
---

<Layout title="Blog posts">
  <main class="container mx-auto px-4 py-8 max-w-3xl prose">
    <h1>Blog posts</h1>
    <ul class="list-none p-0">
      {
        sortedPosts.map((post: any) => (
          <li class="grid grid-cols-2 gap-4 items-baseline">
            <div class="flex items-center gap-2">
              <a href={"/blog/" + post.slug}>{post.data.title}</a>
              {post.data.type === "link" && (
                <>
                  <span class="text-xs bg-blue-100 text-blue-800 rounded-md px-2 py-0.5">
                    Link
                  </span>
                  {post.data.externalUrl && (
                    <a
                      href={post.data.externalUrl}
                      target="_blank"
                      rel="noopener noreferrer"
                      aria-label="Open original article"
                      class="text-gray-500 hover:text-gray-800"
                      title="Open original article"
                    >
                      â†—
                    </a>
                  )}
                </>
              )}
            </div>
            <time datetime={post.data.date.toISOString()}>
              {post.data.date.toLocaleDateString("en-US", {
                year: "numeric",
                month: "long",
                day: "numeric",
              })}
            </time>
          </li>
        ))
      }
    </ul>
    <p class="italic text-gray-700 mt-12">
      I did a bit of writing on Medium, back in the days in a Product Hacking
      collection: <a
        href="https://medium.com/product-hacking"
        class="text-primary hover:underline"
        >https://medium.com/product-hacking</a
      >
    </p>
  </main>
</Layout>
